<p>
    To keep up and running Botmasters may try to change domain name of the C&C server, one way to achieve this is to get
    Bots to generate the new domain name using a one-way hash function

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Patrick Butler, Kui Xu, and Danfeng (Daphne) Yao, “Quantitatively Analysing Stealthy Communication Channels”, Dept. of Computer Science, Virginia Tech, Blacksburg, VA 24060. Matthew Thomas, Aziz Mohaisen, “Kindred Domains: Detecting and Clustering Botnet Domains">
        [22].
    </button>

    We can then calculate the dissimilarity between a generated domain and a legitimate domain, compared to the
    dissimilarity between two legitimate domains, we would expect, on average, the generated name and the legitimate one
    to have a larger mahalanobis distance than domains of the same type

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Patrick Butler, Kui Xu, and Danfeng (Daphne) Yao, “Quantitatively Analysing Stealthy Communication Channels”, Dept. of Computer Science, Virginia Tech, Blacksburg, VA 24060. Matthew Thomas, Aziz Mohaisen, “Kindred Domains: Detecting and Clustering Botnet Domains">
        [22].
    </button>

    An unrecognised domain is classified as generated when

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Stefano Schiavoni Federico Maggi Lorenzo Cavallaro Stefano Zanero Politecnico di Milano Politecnico di Milano Royal Holloway University of London Politecnico di Milano, “Tracking and Detection Botnets Using Automatically Generated Domains”, arXiv:1311.5612v1 [cs.CR] 21 Nov 2013">
        [24].
    </button>


    the attribute vector is deemed anomalous by criteria of the Mahalanobis distance function shown above. We take a
    constants λ and Λ to be the 70th and 90th percentile, respectively, of the underlying distribution to estimate a
    threshold for generated domains

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Stefano Schiavoni Federico Maggi Lorenzo Cavallaro Stefano Zanero Politecnico di Milano Politecnico di Milano Royal Holloway University of London Politecnico di Milano, “Tracking and Detection Botnets Using Automatically Generated Domains”, arXiv:1311.5612v1 [cs.CR] 21 Nov 2013">
        [24].
    </button>

    The specific threshold depends largely on the domain generation algorithm

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Stefano Schiavoni Federico Maggi Lorenzo Cavallaro Stefano Zanero Politecnico di Milano Politecnico di Milano Royal Holloway University of London Politecnico di Milano, “Tracking and Detection Botnets Using Automatically Generated Domains”, arXiv:1311.5612v1 [cs.CR] 21 Nov 2013">
        [24].
    </button>

    Shown in the adjacent image is the plotted cumulative distribution function of top 100,000 Alexa domains, where X is is
    an attribute vector

    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Stefano Schiavoni Federico Maggi Lorenzo Cavallaro Stefano Zanero Politecnico di Milano Politecnico di Milano Royal Holloway University of London Politecnico di Milano, “Tracking and Detection Botnets Using Automatically Generated Domains”, arXiv:1311.5612v1 [cs.CR] 21 Nov 2013">
        [24].
    </button>

</p>

<pre>
    <p>mahalanobis'(x,y) = &sum; i=1 ^n (|xi-yi|&frasl;&sigma;yi + &alpha;)</p>
</pre>


<p>
    An issue may arise where the computation of the inverse of the covariance matrix is expensive, in this case a
    simplification has been formulated
    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Ke Wang, Salvatore J. Stolfo, “Anomalous payload-based network intrusion detection”, In Recent Advance in Intrusion Detection (RAID), Sep 2004.">
        [6].
    </button>

    The simplified mahalanobis distance equivalent relies on the assumption
    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Ricardo Villamarín-Salomón, José Carlos Brustoloni, “Identifying Botnets using anomaly detection techniques applied to DNS traffic”">
        [3]
    </button>

    that the elements of σ are independent.
    The smoothing constant exists to account for when attributes happen to be constant across recorded data points
    <button type="button"
            class="btn btn-sm reference"
            data-toggle="tooltip" data-placement="right"
            title="Ricardo Villamarín-Salomón, José Carlos Brustoloni, “Identifying Botnets using anomaly detection techniques applied to DNS traffic”">
        [3]
    </button>

</p>
